
#!/usr/bin/python
#This little script is meant to assist in the recovery of files from the Microsoft Security Essentials/Antimalware LocalCopy  'format'.
#It essentially xor's the file with 0xff
#Provided by Corey Forman (fetchered [at] gmail [dot] com)

import sys
def xor(): 
    try:
	byte=bytearray(open(sys.argv[1], 'rb').read())
        for i in range(len(byte)):
	    byte[i] ^= 0xff
        open(sys.argv[2], 'wb').write(byte)
    except:
        print '\033[1;31m[!] Check your inputs and try again\033[1;31m'
xor()
